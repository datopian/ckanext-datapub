{"version":3,"sources":["../node_modules/tableschema/lib/profiles sync /^/.//.*/.json$","components/ProgressBar/index.jsx","utils/index.js","components/Upload/index.jsx","components/SelectSchema/index.js","components/Metadata/index.jsx","App.js","index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","ProgressBar","props","useState","offset","setOffset","circleRef","useRef","size","progress","strokeWidth","circleOneStroke","circleTwoStroke","timeRemaining","center","radius","circumference","Math","PI","useEffect","current","style","className","width","height","stroke","cx","cy","r","ref","strokeDasharray","strokeDashoffset","x","y","floor","onFormatBytes","bytes","decimals","k","dm","sizes","i","log","parseFloat","pow","toFixed","Upload","onChangeHandler","event","a","state","formattedSize","selectedFile","allowedFormats","target","files","length","file","data","includes","descriptor","format","addSchema","console","warn","setState","loaded","success","fileExists","error","self","hash","onHashProgress","metadataHandler","assign","onClickHandler","hashInProgress","hashLoaded","onUploadProgress","progressEvent","onTimeRemaining","total","progressLoaded","kbps","Date","getTime","start","fileSize","client","resource","loading","handleUploadStatus","pushBlob","then","response","catch","datasetId","this","onChangeUrl","value","round","name","React","Component","SelectSchema","resources","onSchemaSelected","selectedSchema","setSelectedSchema","onChangeHandlder","resourceId","onChange","index","schema","key","disabled","customFields","label","input_type","values","options","Metadata","metadata","handleChange","path","htmlFor","type","title","description","encoding","required","encodeData","item","toLowerCase","formatData","option","ResourceEditor","handleChangeMetadata","resourceCopy","handleSubmitMetadata","createResource","action","datasetMetadata","result","window","location","href","config","organizationId","urlName","ckanResource","frictionlessCkanMapper","resourceFrictionlessToCkan","sample","bqTableName","bq_table_name","uuidv4","ckanResourceCopy","package_id","sha256","lfs_prefix","url","url_type","replace","onChangeResourceId","deleteResource","confirm","setLoading","isLoading","ui","status","newUiState","getSchemaWithSample","resourceSchema","resourceSample","fields","property","push","setResource","isResourceEdit","fileOrLink","uploadComplete","undefined","bind","authToken","api","lfs","Client","fileResource","extendResource","newResource","newName","split","toUpperCase","onSubmit","preventDefault","onClick","defaultProps","element","document","getElementById","getAttribute","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.69bfa75f.chunk.js","sourcesContent":["var map = {\n\t\"./geojson.json\": 279,\n\t\"./table-schema.json\": 620,\n\t\"./topojson.json\": 280\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 619;","import React, { useEffect, useState, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport \"./ProgressBar.css\";\n\nconst ProgressBar = (props) => {\n  const [offset, setOffset] = useState(0);\n  const circleRef = useRef(null);\n  const {\n    size,\n    progress,\n    strokeWidth,\n    circleOneStroke,\n    circleTwoStroke,\n    timeRemaining,\n  } = props;\n\n  const center = size / 2;\n  const radius = size / 2 - strokeWidth / 2;\n  const circumference = 2 * Math.PI * radius;\n\n  useEffect(() => {\n    const progressOffset = ((100 - progress) / 100) * circumference;\n    setOffset(progressOffset);\n\n    circleRef.current.style = \"transition: stroke-dashoffset 850ms ease-in-out\";\n  }, [setOffset, progress, circumference, offset]);\n\n  return (\n    <>\n      <svg className=\"svg\" width={size} height={size}>\n        <circle\n          className=\"svg-circle-bg\"\n          stroke={circleOneStroke}\n          cx={center}\n          cy={center}\n          r={radius}\n          strokeWidth={strokeWidth}\n        />\n        <circle\n          className=\"svg-circle\"\n          ref={circleRef}\n          stroke={circleTwoStroke}\n          cx={center}\n          cy={center}\n          r={radius}\n          strokeWidth={strokeWidth}\n          strokeDasharray={circumference}\n          strokeDashoffset={offset}\n        />\n        <text x={`${center}`} y={`${center + 2}`} className=\"svg-circle-text\">\n          {progress}%\n        </text>\n      </svg>\n      {timeRemaining > 0 &&  <span className=\"time-remaining\">{timeRemaining > 60 ? `${Math.floor(timeRemaining /60)} minute${Math.floor(timeRemaining /60) > 1 ? 's' : ''}` : `${Math.floor(timeRemaining)} second${timeRemaining > 1 ? 's' : ''}`} left</span>}\n    </>\n  );\n};\n\nProgressBar.propTypes = {\n  size: PropTypes.number.isRequired,\n  progress: PropTypes.number.isRequired,\n  strokeWidth: PropTypes.number.isRequired,\n  circleOneStroke: PropTypes.string.isRequired,\n  circleTwoStroke: PropTypes.string.isRequired,\n};\n\nexport default ProgressBar;\n","const onFormatBytes = (bytes, decimals = 1) => {\n  if (bytes === 0) return \"0 Bytes\";\n\n  const k = 1000;\n  const dm = decimals < 0 ? 0 : decimals;\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\n\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + \" \" + sizes[i];\n};\n\nconst removeHyphen = (id) => {\n  return id.replace(/-/g, \"\");\n};\n\nexport { removeHyphen,\n        onFormatBytes };\n","import React from \"react\";\nimport * as data from \"frictionless.js\";\nimport ProgressBar from \"../ProgressBar\";\nimport { onFormatBytes } from \"../../utils\";\nimport { Choose } from \"datapub\";\n\nclass Upload extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      datasetId: props.datasetId,\n      selectedFile: null,\n      fileSize: 0,\n      formattedSize: \"0 KB\",\n      start: \"\",\n      loaded: 0,\n      success: false,\n      error: false,\n      fileExists: false,\n      loading: false,\n      timeRemaining: 0,\n      hashInProgress: false,\n      hashLoaded: 0\n    };\n  }\n\n  onChangeHandler = async (event) => {\n    let { formattedSize, selectedFile } = this.state;\n    const allowedFormats = ['csv', 'tsv', 'xls', 'xlsx', 'zip', 'pdf', 'json', 'geojson'];\n    \n    if (event.target.files.length > 0) {\n      selectedFile = event.target.files[0];\n      const file = data.open(selectedFile);\n\n      if ([ 'csv', 'tsv', 'xls', 'xlsx'].includes(file.descriptor.format)) {\n        try {\n          await file.addSchema();\n        } catch (e) {\n          console.warn(e);\n        }\n       } \n\n      if (!allowedFormats.includes(file.descriptor.format)) {\n        this.setState({\n          selectedFile,\n          loaded: 0,\n          success: false,\n          fileExists: false,\n          error: 'File format not supported',\n        });\n        return;\n      }\n\n      formattedSize = onFormatBytes(file.size);\n      let self = this;\n      const hash = await file.hash(\"sha256\", (progress) => {\n        self.onHashProgress(progress);\n      });\n      this.props.metadataHandler(Object.assign(file.descriptor, { hash }));\n    }\n\n    this.setState({\n      selectedFile,\n      loaded: 0,\n      success: false,\n      fileExists: false,\n      error: false,\n      formattedSize,\n    });\n\n    await this.onClickHandler();\n  };\n\n  onHashProgress = (progress) => {\n    if (progress === 100) {\n      this.setState({ hashInProgress: false });\n    } else {\n      this.setState({ hashLoaded: progress, hashInProgress: true });\n    }\n  };\n\n  onUploadProgress = (progressEvent) => {\n    this.onTimeRemaining(progressEvent.loaded);\n    this.setState({\n      loaded: (progressEvent.loaded / progressEvent.total) * 100,\n    });\n  };\n\n  onTimeRemaining = (progressLoaded) => {\n    const end = new Date().getTime();\n    const duration = (end - this.state.start) / 1000;\n    const bps = progressLoaded / duration;\n    const kbps = bps / 1024;\n    const timeRemaining = (this.state.fileSize - progressLoaded) / kbps;\n\n    this.setState({\n      timeRemaining: timeRemaining / 1000,\n    });\n  };\n\n  onClickHandler = async () => {\n    const start = new Date().getTime();\n    const { selectedFile } = this.state;\n    const { client } = this.props;\n\n    const resource = data.open(selectedFile);\n\n    this.setState({\n      fileSize: resource.size,\n      start,\n      loading: true,\n    });\n\n    this.props.handleUploadStatus({\n      loading: true,\n      error: false,\n      success: false,\n    });\n\n    // Use client to upload file to the storage and track the progress\n    client\n      .pushBlob(resource, this.onUploadProgress)\n      .then((response) => {\n        this.setState({\n          success: true,\n          loading: false,\n          fileExists: ! response,\n          loaded: 100\n        });\n        this.props.handleUploadStatus({\n          loading: false,\n          success: true,\n        });\n      })\n      .catch((error) => {\n        console.error(\"Upload failed with error: \" + error);\n        this.setState({ error: true, loading: false });\n        this.props.handleUploadStatus({\n          loading: false,\n          success: false,\n          error: true,\n        });\n      });\n  };\n\n  render() {\n    const {\n      success,\n      fileExists,\n      error,\n      timeRemaining,\n      selectedFile,\n      formattedSize,\n      hashInProgress\n    } = this.state;\n    return (\n      <div className=\"upload-area\">\n        <Choose\n          onChangeHandler={this.onChangeHandler}\n          onChangeUrl={(event) => console.log(\"Get url:\", event.target.value)}\n        />\n        <div className=\"upload-area__info\">\n          {hashInProgress && (\n            <>\n              <ul className=\"upload-list\">\n                <li className=\"list-item\">\n                  <div className=\"upload-list-item\">\n                    <div>\n                      <p className=\"upload-file-name\">Computing file hash...</p>\n                    </div>\n                    <div>\n                      <ProgressBar\n                        progress={Math.round(this.state.hashLoaded)}\n                        size={100}\n                        strokeWidth={5}\n                        circleOneStroke=\"#d9edfe\"\n                        circleTwoStroke={\"#7ea9e1\"}\n                      />\n                    </div>\n                  </div>\n                </li>\n              </ul>\n            </>\n          )}\n        </div>\n        <div className=\"upload-area__info\">\n          {selectedFile && (\n            <>\n              <ul className=\"upload-list\">\n                <li className=\"list-item\">\n                  <div className=\"upload-list-item\">\n                    <div>\n                      <p className=\"upload-file-name\">Uploading {selectedFile.name}</p>\n                      <p className=\"upload-file-size\">{formattedSize}</p>\n                    </div>\n                    <div>\n                      <ProgressBar\n                        progress={Math.round(this.state.loaded)}\n                        size={100}\n                        strokeWidth={5}\n                        circleOneStroke=\"#d9edfe\"\n                        circleTwoStroke={\"#7ea9e1\"}\n                        timeRemaining={timeRemaining}\n                      />\n                    </div>\n                  </div>\n                </li>\n              </ul>\n              <h2 className=\"upload-message\">\n                {success &&\n                  !fileExists &&\n                  !error &&\n                  \"File uploaded successfully\"}\n                {fileExists && \"File uploaded successfully\"}\n                {error && `Upload failed ${typeof error === 'string' ? error : ''}`}\n              </h2>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Upload;\n","import React, { useState } from \"react\";\n\nimport PropTypes from \"prop-types\";\n\nconst SelectSchema = ({ resources, client, onSchemaSelected }) => {\n  const [selectedSchema, setSelectedSchema] = useState(\"\");\n\n  const onChangeHandlder = async (event) => {\n    const resourceId = event.target.value;\n    setSelectedSchema(event.target.value);\n    onSchemaSelected(resourceId);\n  };\n  return (\n    <div className=\"app-form-field\">\n      <label className=\"metadata-label\">\n        Copy metadata information from existing resource\n      </label>\n      <select\n        className=\"app-form-field-input\"\n        value={selectedSchema}\n        onChange={onChangeHandlder}\n      >\n        <option value=\"\">Select...</option>\n        {resources.map(({ name, schema, id }, index) => {\n          return (\n            <option\n              key={`select-schema-option-${id}-${index}`}\n              value={id}\n              disabled={!schema}\n            >\n              {name} {!schema ? \"(no schema to copy)\" : \"\"}\n            </option>\n          );\n        })}\n      </select>\n    </div>\n  );\n};\n\nSelectSchema.propTypes = {\n  resources: PropTypes.array.isRequired,\n  onSchemaSelected: PropTypes.func.isRequired,\n};\n\nexport default SelectSchema;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport \"./Metadata.css\";\nimport { encodeData, formatData } from \"datapub\";\n\n//TODO: add the custom fields as a props and render it in metadata component\nconst customFields = [\n  {\n    label: \"Access Restriction\",\n    name: \"restricted\",\n    input_type: \"select\",\n    values: ['{\"level\": \"public\"}', '{\"level\": \"private\"}'],\n    options: [\"Public\", \"Private\"],\n  },\n];\n\nconst Metadata = ({ metadata, handleChange }) => {\n  return (\n    <>\n      <h3 className=\"metadata-name\">{metadata.path}</h3>\n      <div className=\"metadata-form\">\n        <div className=\"metadata-input\">\n          <label className=\"metadata-label\" htmlFor=\"title\">\n            Title\n          </label>\n          <input\n            className=\"metadata-input__input\"\n            type=\"text\"\n            name=\"title\"\n            id=\"title\"\n            value={metadata.title || metadata.name}\n            onChange={handleChange}\n          />\n        </div>\n        <div className=\"metadata-input\">\n          <label className=\"metadata-label\" htmlFor=\"description\">\n            Description\n          </label>\n          <input\n            className=\"metadata-input__input\"\n            type=\"text\"\n            name=\"description\"\n            id=\"description\"\n            value={metadata.description || \"\"}\n            onChange={handleChange}\n          />\n        </div>\n        <div className=\"metadata-input\">\n          <label className=\"metadata-label\" htmlFor=\"encoding\">\n            Encoding\n          </label>\n          <select\n            className=\"metadata-input__input\"\n            name=\"encoding\"\n            id=\"encoding\"\n            value={metadata.encoding || \"\"}\n            onChange={handleChange}\n            required\n          >\n            <option value=\"\" disabled>\n              Select...\n            </option>\n            {encodeData.map((item) => (\n              <option key={`format-${item.value}`} value={item.value}>\n                {item.label}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div className=\"metadata-input\">\n          <label className=\"metadata-label\" htmlFor=\"format\">\n            Format\n          </label>\n          <select\n            className=\"metadata-input__input\"\n            name=\"format\"\n            id=\"format\"\n            value={(metadata.format || \"\").toLowerCase()}\n            onChange={handleChange}\n            required\n          >\n            <option value=\"\" disabled>\n              Select...\n            </option>\n            {formatData.map((item) => (\n              <option key={`format-${item[0]}`} value={item[0].toLowerCase()}>\n                {item[0]}\n              </option>\n            ))}\n          </select>\n        </div>\n        {customFields &&\n          customFields.map((item) => (\n            <div\n              key={`metadata-custom-${item.name}`}\n              className=\"metadata-input\"\n            >\n              <label className=\"metadata-label\" htmlFor=\"format\">\n                {item.label}\n              </label>\n              <select\n                className=\"metadata-input__input\"\n                name={item.name}\n                id={item.name}\n                value={metadata[item.name] || \"\"}\n                onChange={handleChange}\n                required\n              >\n                <option value=\"\" disabled>\n                  Select...\n                </option>\n                {item.options.map((option, index) => (\n                  <option\n                    key={`${item.name}-${index}`}\n                    value={item.values[index]}\n                  >\n                    {option}\n                  </option>\n                ))}\n              </select>\n            </div>\n          ))}\n      </div>\n    </>\n  );\n};\n\nMetadata.propTypes = {\n  metadata: PropTypes.object.isRequired,\n  handleChange: PropTypes.func.isRequired,\n};\n\nexport default Metadata;\n","import React from \"react\";\nimport { Client } from \"ckanClient\";\nimport PropTypes from \"prop-types\";\nimport frictionlessCkanMapper from \"frictionless-ckan-mapper-js\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { TableSchema } from \"datapub\";\nimport Upload from \"./components/Upload\";\nimport SelectSchema from \"./components/SelectSchema\";\nimport Metadata from \"./components/Metadata\";\nimport \"./App.css\";\nimport { removeHyphen } from \"./utils\";\n\nexport class ResourceEditor extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      resources: [],\n      datasetId: this.props.config.datasetId,\n      resourceId: \"\",\n      resource: this.props.resource || {},\n      ui: {\n        fileOrLink: \"\",\n        uploadComplete: undefined,\n        success: false,\n        error: false,\n        loading: false,\n      },\n      client: null,\n      isResourceEdit: false,\n    };\n    this.metadataHandler = this.metadataHandler.bind(this);\n  }\n\n  async componentDidMount() {\n    const { config } = this.props;\n    const {\n      authToken,\n      api,\n      lfs,\n      organizationId,\n      datasetId,\n      resourceId,\n    } = config;\n\n    const client = new Client(\n      `${authToken}`,\n      `${organizationId}`,\n      `${datasetId}`,\n      `${api}`,\n      `${lfs}`\n    );\n\n    // get dataset\n    const { result } = await client.action(\"package_show\", {\n      id: datasetId,\n    });\n\n    const resources = result.resources || [];\n\n    this.setState({ client, resources });\n\n    //Check if the user is editing resource\n    if (resourceId) {\n      this.setResource(resourceId);\n    }\n  }\n\n  metadataHandler(fileResource) {\n    let resource = this.extendResource(fileResource);\n    this.setState({\n      resource,\n    });\n  }\n\n  /**\n   * Adds a new field bq_table_name to resources and formats name property\n   * @param {Object} resource\n   */\n  extendResource(resource) {\n    let newResource = { ...resource };\n    newResource.title = resource.name;\n    newResource.urlName = resource.name;\n    newResource.size = resource.size;\n\n    const newName = resource.name.split(\".\")[0].toUpperCase();\n    newResource.name = newName;\n    newResource.bq_table_name = newName;\n    return newResource;\n  }\n\n  handleChangeMetadata = (event) => {\n    const target = event.target;\n    const value = target.value;\n    const name = target.name;\n    let resourceCopy = this.state.resource;\n    resourceCopy[name] = value;\n\n    this.setState({\n      resource: resourceCopy,\n    });\n  };\n\n  handleSubmitMetadata = async () => {\n    const { resource, client } = this.state;\n    await this.createResource(resource);\n\n    // Change state of dataset to active if draft atm\n    // this relates to how CKAN v2 has a phased dataset creation. See e.g.\n    // https://github.com/ckan/ckan/blob/master/ckan/controllers/package.py#L917\n\n    // only need to do this test if in resource create mode if editing a\n    // resource this is unnecessary\n    // TODO: update this in future to check for edit mode\n    const isResourceCreate = true;\n    if (isResourceCreate) {\n      const datasetMetadata = await client.action(\"package_show\", {\n        id: this.state.datasetId,\n      });\n      let result = datasetMetadata.result;\n\n      if (result.state === \"draft\") {\n        result.state = \"active\";\n        await client.action(\"package_update\", result);\n      }\n    }\n\n    // Redirect to dataset page\n    return (window.location.href = `/dataset/${this.state.datasetId}`);\n  };\n\n  createResource = async (resource) => {\n    const { client } = this.state;\n    const { config } = this.props;\n    const { organizationId, datasetId, resourceId } = config;\n    const { urlName } = resource;\n    delete resource.urlName;\n\n    const ckanResource = frictionlessCkanMapper.resourceFrictionlessToCkan(\n      resource\n    );\n\n    //create a valid format from sample\n    let data = { ...ckanResource.sample };\n    //delete sample because is an invalid format\n    delete ckanResource.sample;\n    //generate an unique id for bq_table_name property\n    let bqTableName = ckanResource.bq_table_name\n      ? ckanResource.bq_table_name\n      : uuidv4();\n    // create a copy from ckanResource to add package_id, name, url, sha256,size, lfs_prefix, url, url_type\n    // without this properties ckan-blob-storage doesn't work properly\n    let ckanResourceCopy = {\n      ...ckanResource,\n      package_id: this.state.datasetId,\n      name: resource.name || resource.title,\n      sha256: resource.hash,\n      size: resource.size,\n      lfs_prefix: `${organizationId}/${datasetId}`,\n      url: urlName,\n      url_type: \"upload\",\n      bq_table_name: removeHyphen(bqTableName),\n      sample: data,\n    };\n\n    //Check if the user is editing resource, call resource_update and redirect to the dataset page\n    if (resourceId) {\n      ckanResourceCopy = {\n        ...ckanResourceCopy,\n        id: resourceId,\n      };\n      if(!urlName) {\n        ckanResourceCopy.url = `${resource?.name?.toLowerCase()}.${resource?.format?.toLowerCase()}`\n      }\n      await client.action(\"resource_update\", ckanResourceCopy);\n\n      return (window.location.href = `/dataset/${datasetId}`);\n    }\n    await client\n      .action(\"resource_create\", ckanResourceCopy)\n      .then((response) => {\n        this.onChangeResourceId(response.result.id);\n      });\n  };\n\n  deleteResource = async () => {\n    const { resource, client, datasetId } = this.state;\n    if (window.confirm(\"Are you sure to delete this resource?\")) {\n      await client.action(\"resource_delete\", { id: resource.id });\n\n      return (window.location.href = `/dataset/${datasetId}`);\n    }\n  };\n\n  setLoading = (isLoading) => {\n    this.setState({\n      ui: { ...this.state.ui, loading: isLoading },\n    });\n  };\n\n  handleUploadStatus = (status) => {\n    const { ui } = this.state;\n    const newUiState = {\n      ...ui,\n      success: status.success,\n      error: status.error,\n      loading: status.loading,\n    };\n\n    this.setState({ ui: newUiState });\n  };\n\n  onChangeResourceId = (resourceId) => {\n    this.setState({ resourceId });\n  };\n\n  onSchemaSelected = async (resourceId) => {\n    this.setLoading(true);\n    const { sample, schema } = await this.getSchemaWithSample(resourceId);\n    this.setLoading(false);\n\n    this.setState({\n      resource: Object.assign(this.state.resource, { schema, sample }),\n    });\n  };\n\n  getSchemaWithSample = async (resourceId) => {\n    const { client } = this.state;\n\n    const resourceSchema = await client.action(\"resource_schema_show\", {\n      id: resourceId,\n    });\n    const resourceSample = await client.action(\"resource_sample_show\", {\n      id: resourceId,\n    });\n\n    const sample = [];\n\n    const schema = resourceSchema.result || { fields: [] };\n\n    try {\n      // push the values to an array\n      for (const property in resourceSample.result) {\n        sample.push(resourceSample.result[property]);\n      }\n    } catch (e) {\n      console.error(e);\n      //generate empty values not to break the tableschema component\n    }\n\n    return { schema, sample };\n  };\n\n  setResource = async (resourceId) => {\n    const { client } = this.state;\n\n    const { result } = await client.action(\"resource_show\", { id: resourceId });\n\n    let resourceCopy = {\n      ...result,\n      ...(await this.getSchemaWithSample(resourceId)),\n    };\n\n    return this.setState({\n      client,\n      resourceId,\n      resource: resourceCopy,\n      isResourceEdit: true,\n    });\n  };\n\n  render() {\n    const { success, loading } = this.state.ui;\n\n    return (\n      <div className=\"App\">\n        <form\n          className=\"upload-wrapper\"\n          onSubmit={(event) => {\n            event.preventDefault();\n            if (this.state.isResourceEdit) {\n              return this.createResource(this.state.resource);\n            }\n            return this.handleSubmitMetadata();\n          }}\n        >\n          <div className=\"upload-header\">\n            <h2 className=\"upload-header__title\">Resource Editor</h2>\n          </div>\n\n          <Upload\n            client={this.state.client}\n            resource={this.state.resource}\n            metadataHandler={this.metadataHandler}\n            datasetId={this.state.datasetId}\n            handleUploadStatus={this.handleUploadStatus}\n            onChangeResourceId={this.onChangeResourceId}\n          />\n\n          <div className=\"upload-edit-area\">\n            <Metadata\n              metadata={this.state.resource}\n              handleChange={this.handleChangeMetadata}\n            />\n            <div className=\"app-form-grid app-divider\">\n              <SelectSchema\n                resources={this.state.resources}\n                onSchemaSelected={this.onSchemaSelected}\n              />\n            </div>\n            {this.state.resource.schema && Object.keys(this.state.resource.schema).length > 0 && (\n              <TableSchema\n                schema={this.state.resource.schema}\n                data={this.state.resource.sample || []}\n              />\n            )}\n            {!this.state.isResourceEdit ? (\n              <button disabled={!success || loading} className=\"btn\">\n                Save and Publish\n              </button>\n            ) : (\n              <div className=\"resource-edit-actions\">\n                <button\n                  type=\"button\"\n                  className=\"btn btn-delete\"\n                  onClick={this.deleteResource}\n                >\n                  Delete\n                </button>\n                <button className=\"btn\">Update</button>\n              </div>\n            )}\n          </div>\n        </form>\n      </div>\n    );\n  }\n}\n\n/**\n * If the parent component doesn't specify a `config` and scope prop, then\n * the default values will be used.\n * */\nResourceEditor.defaultProps = {\n  config: {\n    authToken: \"be270cae-1c77-4853-b8c1-30b6cf5e9878\",\n    api: \"http://localhost:5000\",\n    lfs: \"http://localhost:5001\", // Feel free to modify this\n    organizationId: \"myorg\",\n    datasetId: \"data-test-2\",\n  },\n};\n\nResourceEditor.propTypes = {\n  config: PropTypes.object.isRequired,\n};\n\nexport default ResourceEditor;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\n// Automatically mount the app if an element with id='ResourceEditor' exists\nconst element = document.getElementById(\"ResourceEditor\");\nif (element) {\n  const config = {\n    datasetId: element.getAttribute(\"data-dataset-id\"),\n    api: element.getAttribute(\"data-api\"),\n    lfs: element.getAttribute(\"data-lfs\"),\n    authToken: element.getAttribute(\"data-auth-token\"),\n    organizationId: element.getAttribute(\"data-organization-id\"),\n    resourceId: element.getAttribute(\"data-resource-id\"),\n  };\n\n  ReactDOM.render(\n    <React.StrictMode>\n      <App config={config} resource={element.getAttribute(\"data-resource\")} />\n    </React.StrictMode>,\n    element\n  );\n}\n"],"sourceRoot":""}